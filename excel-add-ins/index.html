<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Excel Add-ins</h2><aside></aside><article><p>See <a href="https://docs.microsoft.com/en-us/office/dev/add-ins/overview/office-add-ins-fundamentals">https://docs.microsoft.com/en-us/office/dev/add-ins/overview/office-add-ins-fundamentals</a>. Also see <a href="https://docs.microsoft.com/en-us/office/dev/add-ins/develop/develop-add-ins-vscode">https://docs.microsoft.com/en-us/office/dev/add-ins/develop/develop-add-ins-vscode</a>.</p><p>To install a tool that generates the initial code for an add-in:</p><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g yo generator-office</code></pre><p>To create an add-in for Excel that is implemented with React and TypeScript:</p><pre class="language-bash"><code class="language-bash">yo office --projectType react --name <span class="token string">"my-excel-add-in"</span> --host excel --ts <span class="token boolean">true</span></code></pre><p>cd my-excel-add-in npm i -D nan npm audit fix npm start You will be prompted for a password. Don't enter one. Instead, press ctrl-c to exit.</p><p>Open the &quot;Keychain Access&quot; app in Applications/utilities. Open the Finder. Open the ~/.office-addin-dev-certs directory. Drag the file <code>ca.crt</code> onto &quot;Keychain Access&quot;.</p><p>npm start</p><p>This time it should not prompt for a password. It will open Excel. Press &quot;Show Taskpane&quot; on the far right. Press &quot;Show Certificate&quot;. Open the &quot;Trust&quot; section. In the &quot;When using this certificate&quot; dropdown, select &quot;Always Trust&quot;. Press &quot;Continue&quot;.</p><p>Press &quot;Restart&quot;.</p><p>If you modify <code>manifest.xml</code>, enter <code>npm run validate</code> to validate it.</p><p>Saving changes should trigger a hot reload inside Excel. You can also press &quot;&gt; Run&quot; in the Taskpane to refresh the React app.</p><p>From a Terminal window enter:</p><pre class="language-text"><code class="language-text">defaults write com.microsoft.Excel OfficeWebAddinDeveloperExtras -bool true</code></pre><p>To see the DevTools Console, right-click anywhere in the running React app and select &quot;Inspect Element&quot; to open the Safari Web Inspector. Then click the &quot;Console&quot; tab. Output from <code>console.log</code> calls will appear here.</p></article>