<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Pandas</h2><aside><nav class="toc"><ol><li><a href="#outstanding-questions">Outstanding Questions</a></li><li><a href="#overview">Overview</a></li><li><a href="#loading-data">Loading Data</a></li><li><a href="#data-types">Data Types</a></li><li><a href="#getting-data">Getting Data</a></li><li><a href="#modifying-data">Modifying Data</a></li><li><a href="#creating-new-dataframes">Creating New DataFrames</a></li><li><a href="#creating-other-representations">Creating Other Representations</a></li><li><a href="#statistics">Statistics</a></li></ol></nav></aside><article><h2 id="outstanding-questions">Outstanding Questions</h2><p>Is a DataFrame a collection of Series objects? Do DataFrame methods always return a new DataFrame? Do the new DataFrame objects share Series and cells with ones they were created from?</p><p>Pandas DataFrames use Numpy arrays.</p><h2 id="overview">Overview</h2><p><a href="https://pandas.pydata.org/" rel="noopener" target="_blank">pandas</a> is a Python library for data analysis. For details, see the <a href="https://pandas.pydata.org/docs/reference/" rel="noopener" target="_blank">API Reference</a>.</p><p>To install pandas, enter <code>pip install pandas</code>.</p><p>To import the pandas library, use <code>import pandas as pd</code>. By convention, &quot;pd&quot; is the name used to refer to the library in code.</p><p>Pandas provides two primary data structures. The <code>Series</code> class is used to represent a series of data values and can be thought of as a single-column spreadsheet. The <code>DataFrame</code> class is used to represent a table of data values and can be thought of as a multi-column spreadsheet. It is used more frequently than <code>Series</code>.</p><h2 id="loading-data">Loading Data</h2><p>A <code>DataFrame</code> can be created from many sources.</p><p>To create a <code>DataFrame</code> from a Python list of dict objects:</p><pre class="language-python"><code class="language-python">dogs_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Maisey'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Treeing Walker Coonhound'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Native American Indian Dog'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Whippet'</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>To create a <code>DataFrame</code> from a CSV file</p><pre class="language-python"><code class="language-python"><span class="token comment"># If the first line contains column names ...</span><br>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file-name.csv'</span><span class="token punctuation">)</span> <span class="token comment"># from comma-separated</span><br>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file-name.csv'</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">)</span> <span class="token comment"># for tab-separate</span><br><br><span class="token comment"># If the first line contains data rather than column names ...</span><br>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file-name.csv'</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'colName1'</span><span class="token punctuation">,</span> <span class="token string">'colName2'</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>To create a <code>DataFrame</code> from an Excel spreadsheet:</p><pre class="language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'file-name.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'name'</span><span class="token punctuation">)</span></code></pre><p>To create a <code>DataFrame</code> from a NumPy array:</p><pre class="language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span>numpy_array<span class="token punctuation">)</span></code></pre><h2 id="data-types">Data Types</h2><p>When pandas creates <code>Series</code> and <code>DataFrame</code> objects from Python data it converts Python string and number types to its own types.</p><table><thead><tr><th>Python type</th><th>pandas type</th></tr></thead><tbody><tr><td>str</td><td>object</td></tr><tr><td>int</td><td>int64</td></tr><tr><td>float</td><td>float64</td></tr></tbody></table><p>For more detail, see <a href="https://pbpython.com/pandas_dtypes.html" rel="noopener" target="_blank">Overview of Pandas Data Types</a>.</p><h2 id="getting-data">Getting Data</h2><p>Note that these just return data. To print it, pass the result to the <code>print</code> function.</p><p>Start indexes (<code>si</code>) are inclusive and default to zero. End indexes (<code>ei</code>) are exclusive and default to length. Column name values below are abbreviated as <code>cn</code>. Row index values below are abbreviated as <code>ri</code>. Column index values below are abbreviated as <code>ci</code>.</p><table><thead><tr><th>Operation</th><th>Code</th></tr></thead><tbody><tr><td>get column names</td><td><code>df.columns</code></td></tr><tr><td>get column data types</td><td><code>df.dtypes</code></td></tr><tr><td>get cell value</td><td><code>df.at[ri, cn]</code> or <code>df.iloc[ri, ci]</code></td></tr><tr><td>get all rows <sup>1</sup></td><td><code>df</code></td></tr><tr><td>get first n rows</td><td><code>df.head(n)</code> where n defaults to 5</td></tr><tr><td>get last n rows</td><td><code>df.tail(n)</code> where n defaults to 5</td></tr><tr><td>get one row</td><td><code>df.iloc[ri]</code></td></tr><tr><td>get row range</td><td><code>df.iloc[si:ei]</code></td></tr><tr><td>get row index values</td><td><code>df.index</code></td></tr><tr><td>get one column as a <code>Series</code> object</td><td><code>df.cn</code> or <code>df[cn]</code></td></tr><tr><td>get one column of specified rows</td><td><code>df[col_name][si:ei]</code></td></tr><tr><td>get multiple columns in specified order</td><td><code>df[[cn1, cn2, ...]]</code></td></tr><tr><td>get rows matching criteria</td><td><code>df.loc(criteria)</code></td></tr><tr><td>get statistics of numeric columns<br>including count, min, max, mean, and std</td><td><code>df.describe()</code></td></tr></tbody></table><p><sup>1</sup> By default the number of rows displayed is limited. To remove the limit <code>pd.set_option('display.max_rows', None)</code>.</p><p>Criteria use bitwise operators for and (<code>&amp;</code>), or (<code>|</code>), and not (<code>~</code>). The example below gets all rows where the <code>name</code> column contains the letter &quot;a&quot; and the <code>breed</code> column consists of three words.</p><pre class="language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>breed<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre><p>To treat <code>Series</code> values as strings, add <code>.str</code>. For example, <code>df.name.str</code>.</p><p>To iterate over all rows:</p><pre class="language-python"><code class="language-python"><span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token comment"># Use index and row (a Series object) here.</span></code></pre><h2 id="modifying-data">Modifying Data</h2><table><thead><tr><th>Operation</th><th>Code</th></tr></thead><tbody><tr><td>set cell value</td><td><code>df.at[ri, cn] = value</code></td></tr><tr><td>add column computed from others</td><td><code>df['new_cn'] = expression</code></td></tr><tr><td>add column that is sum of others <sup>1</sup></td><td><code>df['my sum'] = df.iloc[:, si:ei].sum(axis=1)</code></td></tr><tr><td>delete columns</td><td><code>df = df.drop(columns=['cn1', 'cn2', ...])</code></td></tr></tbody></table><p><sup>1</sup> The first slice (colon) with no number on either side means &quot;all rows&quot;. The second slice specifies a column range. Specifying <code>axis=1</code> means horizontal and <code>axis=0</code> means vertical.</p><p>Suppose we want to add a column named &quot;name length&quot; that holds the length of each &quot;name&quot; value.</p><pre class="language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'name length'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span></code></pre><p>Suppose we have the columns <code>width</code>, <code>depth</code>, and <code>height</code> that represent refrigerator dimensions and we want to add a new <code>volume</code> column.</p><pre class="language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'volume'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>width <span class="token operator">*</span> df<span class="token punctuation">.</span>depth <span class="token operator">*</span> df<span class="token punctuation">.</span>height</code></pre><h2 id="creating-new-dataframes">Creating New DataFrames</h2><p>When a new <code>DataFrame</code> is created from an existing one the new one shares memory with original. So changes to the underlying data affect both <code>DataFrame</code>s.</p><p>By default new <code>DataFrame</code>s retain the same index values at the original. To reset the index values, <code>new_df = new_df.reset_index(drop=True)</code> or <code>new_df.reset_index(drop=True, inplace=True)</code>. Including <code>drop=True</code> removes the original index column.</p><table><thead><tr><th>Operation</th><th>Code</th></tr></thead><tbody><tr><td>sort on one column</td><td><code>df.sort_values('cn', ascending=Bool)</code></td></tr><tr><td>sort on multiple columns</td><td><code>df.sort_values(['cn1', 'cn2'], ascending=[Bool1, Bool2])</code></td></tr><tr><td>transpose</td><td><code>df.T</code></td></tr></tbody></table><p>To sort in place, add <code>inplace=True</code>.</p><h2 id="creating-other-representations">Creating Other Representations</h2><table><thead><tr><th>Operation</th><th>Code</th></tr></thead><tbody><tr><td>create NumPy array</td><td><code>df.to_numpy()</code></td></tr></tbody></table><h2 id="statistics">Statistics</h2><table><thead><tr><th>Operation</th><th>Code</th></tr></thead><tbody><tr><td>get basic statistics for all columns</td><td><code>df.describe()</code></td></tr></tbody></table><p>More detail is coming soon!</p></article>