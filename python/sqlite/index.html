<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>SQLite</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#cli-tool">CLI Tool</a></li><li><a href="#column-types">Column Types</a></li><li><a href="#python-support">Python Support</a></li></ol></nav></aside><article><h2 id="overview">Overview</h2><p>SQLite claims to be &quot;the most used database engine in the world&quot;. It runs on all common operating systems and mobile devices.</p><p>Features of SQLite include:</p><ul><li>atomic transactions</li><li>zero configuration required</li><li>full SQL support</li><li>databases stored in a single, binary file which makes them easy to back up</li><li>small code footprint</li><li>simple API</li><li>fast performance</li><li>implemented in C</li><li>no external dependencies</li><li>wide operating system support</li><li>public domain source code</li><li>includes a command-line interface (CLI)</li></ul><h2 id="cli-tool">CLI Tool</h2><p>To start the SQLite CLI, enter <code>sqlite3</code> optionally followed by a file path to a database file. This displays a <code>sqlite&gt;</code> prompt where you can enter SQL commands (terminated by a semicolon) and &quot;dot commands&quot; that begin with a period.</p><p>For example, here is a sample session that creates a <code>pets</code> database that contains tables for <code>dogs</code> and <code>cats</code>.</p><pre class="language-text"><code class="language-text">$ sqlite3 pets.db<br>sqlite> create table dogs(name string, breed string, age integer);<br>sqlite> create table cats(name string, breed string, remaining_lives integer);<br>sqlite> .schema (displays the schema for each table)<br>sqlite> insert into dogs values('Comet', 'Whippet', 1);<br>sqlite> select * from dogs;<br>sqlite> .exit<br>$ ls *.db</code></pre><p>The file <code>pets.db</code> exist now as long as at least one table was defined.</p><p>The most commonly used dot commands are described in the following table:</p><table><thead><tr><th>Action</th><th>Command</th></tr></thead><tbody><tr><td>change working directory</td><td><code>.cd {directory}</code></td></tr><tr><td>close current database and open new one</td><td><code>.open {file-path}.db</code></td></tr><tr><td>attach an additional database</td><td><code>attach database &quot;{file-path}&quot; as {name};</code></td></tr><tr><td>list names and paths of attached databases</td><td><code>.databases</code></td></tr><tr><td>list tables in current database</td><td><code>.tables</code></td></tr><tr><td>show database schema</td><td><code>.schema</code></td></tr><tr><td>show table schema</td><td><code>.schema {table-name}</code></td></tr><tr><td>configure showing/hiding # of rows changed by SQL</td><td><code>.changes {on|off}</code></td></tr><tr><td>export table to CSV file</td><td><code>.headers on</code><br><code>.mode csv</code><br><code>.once {file-path}</code><br><code>select * from {table-name}</code><br><code>.system {file-path}</code></td></tr><tr><td>import CSV file into a table</td><td><code>.import {file-path} {table-name}</code></td></tr><tr><td>execute shell command</td><td><code>.shell {command}</code></td></tr><tr><td>show current configuration settings</td><td><code>.show</code></td></tr><tr><td>exit</td><td><code>.exit</code> or <code>.quit</code></td></tr></tbody></table><p>When multiple databases are attached, the tables in all of them are accessible and reporting commands such as <code>.tables</code> report on all the databases.</p><p>By default, output from <code>select</code> statements uses <code>list</code> mode where each record is output on a single line with <code>|</code> characters separating column values.</p><p>Here is an example of <code>list</code> mode output:</p><pre class="language-text"><code class="language-text">Maisey|Treeing Walker Coonhound|11<br>Ramsay|Native American Indian Dog|8</code></pre><p>The <code>.mode {mode}</code> command can be used to change this output. Supported modes include <code>list</code>, <code>csv</code>, <code>line</code>, and <code>column</code>.</p><p>Here is an example of <code>csv</code> mode output:</p><pre class="language-text"><code class="language-text">Maisey,"Treeing Walker Coonhound",11<br>Ramsay,"Native American Indian Dog",8</code></pre><p>Here is an example of <code>line</code> mode output:</p><pre class="language-text"><code class="language-text"> name = Maisey<br>breed = Treeing Walker Coonhound<br>  age = 11<br><br> name = Ramsay<br>breed = Native American Indian Dog<br>  age = 8</code></pre><p>Here is an example of <code>column</code> mode output:</p><pre class="language-text"><code class="language-text">Maisey      Treeing Walker Coonhound  11<br>Ramsay      Native American Indian D  8</code></pre><h2 id="column-types">Column Types</h2><p>SQLite supports a small set of column types that include:</p><ul><li>integer</li><li>real</li><li>numeric (for boolean, decimal, date, and datetime values)</li><li>text</li><li>blob</li></ul><p>Use the numeric type for boolean values where 0 is false and 1 is true.</p><p>Use the text type for ISO date strings.</p><p>Use the integer type for storing seconds or milliseconds since the epoch (1970-01-01 00:00:00 UTC).</p><h2 id="python-support">Python Support</h2><p>Python has built-in support for <a href="https://www.sqlite.org/" rel="noopener" target="_blank">SQLite</a> databases provided by the package <code>sqlite3</code>. Here is an example program that performs many common operations.</p><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> sqlite3  <span class="token comment"># included with Python</span><br><br><span class="token comment"># Connect to a database and create it if it doesn't exist.</span><br><span class="token comment"># The database is in a binary file and is not human-readable.</span><br>conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'pets.db'</span><span class="token punctuation">)</span><br><br><span class="token comment"># All database operations occur on a cursor.</span><br>c <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment"># Uncomment this to start with an empty table.</span><br>c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'drop table if exists dogs'</span><span class="token punctuation">)</span><br><br><span class="token comment"># Create a table.</span><br><span class="token comment"># An object id column named "oid" is automatically added.</span><br>c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''<br>    create table if not exists dogs (<br>      name text,<br>      breed text,<br>      age integer<br>    )<br>'''</span><span class="token punctuation">)</span><br><br><span class="token keyword">def</span> <span class="token function">add_dog</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token comment"># Names preceded by a colon are keys in</span><br>    <span class="token comment"># the dict passed as the second argument.</span><br>    <span class="token comment"># The value of the "oid" column is auto-incremented.</span><br>    c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'insert into dogs values (:name, :breed, :age)'</span><span class="token punctuation">,</span> dog<span class="token punctuation">)</span><br><br><span class="token keyword">def</span> <span class="token function">get_dogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token comment"># Selecting * does not get the "oid" column.</span><br>    <span class="token comment"># It must be explicitly requested.</span><br>    c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'select *, oid from dogs'</span><span class="token punctuation">)</span><br>    <span class="token keyword">return</span> c<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># returns list of tuples, one per record</span><br><br><span class="token keyword">def</span> <span class="token function">print_dogs</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> dogs<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'Name'</span><span class="token punctuation">:</span><span class="token format-spec">12</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'Breed'</span><span class="token punctuation">:</span><span class="token format-spec">30</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'OID'</span><span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token format-spec">12</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token format-spec">30</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> dog <span class="token keyword">in</span> dogs<span class="token punctuation">:</span><br>            name<span class="token punctuation">,</span> breed<span class="token punctuation">,</span> age<span class="token punctuation">,</span> oid <span class="token operator">=</span> dog<br>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'  </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token format-spec">12</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span>breed<span class="token punctuation">:</span><span class="token format-spec">30</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token punctuation">{</span>oid<span class="token punctuation">:</span><span class="token format-spec">3</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><br>    <span class="token keyword">else</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'  empty'</span><span class="token punctuation">)</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>dogs <span class="token operator">=</span> get_dogs<span class="token punctuation">(</span><span class="token punctuation">)</span><br>print_dogs<span class="token punctuation">(</span><span class="token string">'initial dogs'</span><span class="token punctuation">,</span> dogs<span class="token punctuation">)</span><br><br><span class="token comment"># If the table is empty, add some rows.</span><br><span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>    add_dog<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Maisey'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Treeing Walker Coonhound'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>    add_dog<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Native American Indian Dog'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>    add_dog<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>    add_dog<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'breed'</span><span class="token punctuation">:</span> <span class="token string">'Whippet'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>    print_dogs<span class="token punctuation">(</span><span class="token string">'dogs after inserts'</span><span class="token punctuation">,</span> get_dogs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment"># Get the oid for Oscar.</span><br>c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'select oid from dogs where name="Oscar"'</span><span class="token punctuation">)</span><br><span class="token builtin">tuple</span> <span class="token operator">=</span> c<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># returns tuple where first element is oid</span><br><span class="token keyword">if</span> <span class="token builtin">tuple</span> <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>  <span class="token comment"># If None is returned, Oscar was not found.</span><br>    oid <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><br>    <span class="token comment"># Update Oscar's name and age.</span><br>    c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'update dogs set name="Oscar Wilde", age=4 where oid='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>oid<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    print_dogs<span class="token punctuation">(</span><span class="token string">'dogs after update'</span><span class="token punctuation">,</span> get_dogs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>    <span class="token comment"># Delete Oscar.</span><br>    c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'delete from dogs where oid='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>oid<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    print_dogs<span class="token punctuation">(</span><span class="token string">'dogs after delete'</span><span class="token punctuation">,</span> get_dogs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># saves changes</span><br>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></article>