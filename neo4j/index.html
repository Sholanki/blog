<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Neo4j</h2><aside><nav class="toc"><ol><li><a href="#installing">Installing</a></li><li><a href="#neo4j-desktop-application">Neo4j Desktop application</a></li><li><a href="#neo4j-browser-application">Neo4j Browser application</a></li><li><a href="#creating-and-deleting-nodes">Creating and deleting nodes</a></li><li><a href="#creating-and-deleting-edges">Creating and deleting edges</a></li><li><a href="#querying">Querying</a></li><li><a href="#cleaning-up">Cleaning up</a></li><li><a href="#creating-and-restoring-backups">Creating and restoring backups</a></li><li><a href="#accessing-from-a-web-app">Accessing from a web app</a></li></ol></nav></aside><article><p><a href="https://neo4j.com/" rel="noopener" target="_blank">Neo4j</a> is a graph database. It was first released in February 2010. There are free and commercial versions. The free version is limited to run on a single node and does not provide hot backups.</p><p>Data is stored as collections of &quot;nodes&quot; that are attached by &quot;edges&quot;. Both nodes and edges can have associated labels and attributes. Attributes can be indexed to support faster searches. Schemas can optionally be defined to specify the attributes that an be specified for each node and edge type. TODO: What is the difference between a label and an attribute?</p><p>Neo4j is implemented in Java, but there are drivers that support accessing Neo4j databases from many programming languages. Officially supported languages include C# (.Net), Go, Java, JavaScript, and Python. Community supported languages include C/C++, Clojure, Erlang, PHP, R, and Ruby.</p><p>&quot;Cypher&quot; is the query language used to obtain data from a Neo4j database. A good summary of Cypher syntax can be found at <a href="https://neo4j.com/docs/cypher-refcard/4.1/" rel="noopener" target="_blank">Neo4j Cypher Refcard</a>.</p><p><a href="https://github.com/neo4j-contrib/neovis.js/" rel="noopener" target="_blank">neovis.js</a> is a JavaScript library for visualizing the result of Cypher queries in a web browser. It connects to a running Neo4j database instance and renders live data updates. TODO: TRY THIS!</p><h2 id="installing">Installing</h2><p>To install Neo4j:</p><ul><li>Browse <a href="https://neo4j.com/" rel="noopener" target="_blank">https://neo4j.com/</a>.</li><li>Click the &quot;GET STARTED&quot; button.</li><li>Click the &quot;Download Neo4j Desktop&quot; button.</li><li>Click the &quot;Download&quot; button.</li><li>Enter the requested information and click the &quot;Download Desktop&quot; button.</li><li>Save the installer file. On macOS, the file name is neo4j-desktop-1.3.10.dmg.</li><li>Save the &quot;Neo4j Desktop Activation Key&quot; that is displayed.</li><li>Double-click the installer file and follow the OS-specific steps.</li></ul><h2 id="neo4j-desktop-application">Neo4j Desktop application</h2><p>To run the Neo4j Desktop application:</p><ul><li>Locate the folder where it was installed.</li><li>Double-click its icon.</li><li>First time only, you will be prompted to paste the &quot;Neo4j Desktop Activation Key&quot;.</li></ul><p><img src="/blog/assets/neo4j-desktop-app.png" alt="Neo4j Desktop app"></p><p>To create a new database:</p><ul><li>Click the large rectangle labeled &quot;+ Add Database&quot;.</li><li>Click &quot;Create a Local Database&quot;.</li><li>Enter a name and password for the database.</li><li>Click the &quot;Create&quot; button.</li></ul><p>To start a database, click its &quot;Start&quot; button.</p><h2 id="neo4j-browser-application">Neo4j Browser application</h2><p>To open a database in a Neo4j Browser window, click its &quot;Open&quot; button in the Neo4j Desktop application. This is somewhat similar to a Jupyter notebook in that it consists of a vertical series of cells into which code can be entered. New code can be entered in the top cell.</p><p><img src="/blog/assets/neo4j-browser.png" alt="Neo4j Browser"></p><p>Icons in the upper-right corner of each cell can be clicked to initiate the following actions:</p><ul><li>save as a favorite (star)</li><li>save as a project file (floppy)</li><li>pin to top (pushpin)</li><li>change to occupy the full screen (opposing arrows)</li><li>collapse to a single line (caret)</li><li>rerun (circle with arrowhead)</li><li>close (X)</li></ul><p><img alt="Neo4j Browser icons" class="keep-size" src="/blog/assets/neo4j-browser-icons.png"></p><p>To execute the code in a cell, click the blue play icon (triangle) on the right side of the cell or press ctrl-enter (cmd-return on macOS).</p><h2 id="creating-and-deleting-nodes">Creating and deleting nodes</h2><p>To create nodes in a Neo4j browser window, enter a Cypher command like the following:</p><pre class="language-text"><code class="language-text">create (Mark:Person {name:'Mark Volkmann', born:1961}),<br>  (Tami:Person {name:'Tami Volkmann', born:1961}),<br>  (Amanda:Person {name:'Amanda Nelson', born:1985}),<br>  (Jeremy:Person {name:'Jeremy Volkmann', born:1987});</code></pre><p>This creates four <code>Person</code> nodes that have <code>name</code> and <code>born</code> attributes. The semicolon at the end is only necessary to enter multiple commands in the same cell.</p><p>To view these <code>Person</code> nodes, enter <code>match (p:Person) return p</code>. By default the selected view type is &quot;Graph&quot; which renders a circle for each <code>Person</code> node. Hover over a node to see the values for its <code>id</code>, <code>born</code>, and <code>name</code> attributes.</p><p>To view only the <code>Person</code> nodes that are born in 1970 or later, enter the following Cypher command:</p><pre class="language-text"><code class="language-text">match p=(person:Person)<br>where person.born >= 1970<br>return p;</code></pre><p>To view only the name attributes of the <code>Person</code> nodes, enter the following Cypher command:</p><pre class="language-text"><code class="language-text">match (person:Person) return person.name</code></pre><h2 id="creating-and-deleting-edges">Creating and deleting edges</h2><p>To create edges (relationships) between nodes, enter a Cypher command like the following:</p><pre class="language-text"><code class="language-text">match (Mark:Person{name: 'Mark Volkmann'})<br>match (Tami:Person{name: 'Tami Volkmann'})<br>match (Amanda:Person{name: 'Amanda Nelson'})<br>match (Jeremy:Person{name: 'Jeremy Volkmann'})<br>with Mark, Tami, Amanda, Jeremy<br>create (Mark)-[:married {year:1981}]->(Tami),<br>  (Mark)-[:father]->(Amanda),<br>  (Mark)-[:father]->(Jeremy),<br>  (Tami)-[:mother]->(Amanda),<br>  (Tami)-[:mother]->(Jeremy);</code></pre><p>To view all the instances of a specific node type, along with connecting lines for their edges, enter a Cypher command like the following:</p><pre class="language-text"><code class="language-text">match (p:Person) return p</code></pre><p><img alt="Neo4j Person relationships" class="keep-size" src="/blog/assets/neo4j-person-relationships.png"></p><p>The nodes in the diagram can be dragged to new positions in order to manually change their layout.</p><p>To export a diagram as CSV, JSON, PNG, or SVG, click the download icon in the upper-right corner of its cell and select one of those formats.</p><p>In addition to displaying query results as a &quot;Graph&quot;, they can also be viewed as a &quot;Table&quot;, &quot;Text&quot;, or &quot;Code&quot; by clicking the corresponding buttons on the left side of the cell.</p><p>To temporarily hide a node, click its circle and then click the icon containing an eye with a minus sign.</p><p><img alt="Neo4j node selected" class="keep-size" src="/blog/assets/neo4j-node-selected.png"></p><p>To get only the nodes that have a specific relationship, enter a Cypher query like the following:</p><pre class="language-text"><code class="language-text">match (p1:Person)-[m:father]->(p2:Person) return p1, m, p2</code></pre><p><img alt="Neo4j father edges" class="keep-size" src="/blog/assets/neo4j-father-edges.png"></p><p>Let's make this more interesting by adding <code>Dog</code> nodes and relationships between them and their <code>Person</code> owners.</p><pre class="language-text"><code class="language-text">create (Maisey:Dog {name:'Maisey', breed:'Treeing Walker Coonhound'}),<br>  (Ramsay:Dog {name:'Ramsay', breed:'Native American Indian Dog'}),<br>  (Oscar:Dog {name:'Oscar', breed:'German Shorthaired Pointer'}),<br>  (Comet:Dog {name:'Comet', breed:'Whippet'});<br><br>match (Mark:Person{name: 'Mark Volkmann'}),<br>  (Tami:Person{name: 'Tami Volkmann'}),<br>  (Amanda:Person{name: 'Amanda Nelson'}),<br>  (Jeremy:Person{name: 'Jeremy Volkmann'}),<br>  (Maisey:Dog{name: 'Maisey'}),<br>  (Ramsay:Dog{name: 'Ramsay'}),<br>  (Oscar:Dog{name: 'Oscar'}),<br>  (Comet:Dog{name: 'Comet'})<br>with Mark, Tami, Amanda, Jeremy, Maisey, Ramsay, Oscar, Comet<br>create (Mark)-[:owns {role:'secondary'}]->(Comet),<br>  (Tami)-[:owns {role:'primary'}]->(Comet),<br>  (Amanda)-[:owns {role:'primary'}]->(Maisey),<br>  (Amanda)-[:owns {role:'primary'}]->(Oscar),<br>  (Jeremy)-[:owns {role:'primary'}]->(Ramsay);</code></pre><h2 id="querying">Querying</h2><p>To view all the nodes we have created, along with the edges between them, enter the following Cypher command:</p><pre class="language-text"><code class="language-text">match (n) return n</code></pre><p><img alt="Neo4j all nodes" class="keep-size" src="/blog/assets/neo4j-all-nodes.png"></p><p>Queries can be more specific. For example, the following Cypher command only renders ...:</p><pre class="language-text"><code class="language-text">match (p:Person) where p.name starts with 'Amanda' return p</code></pre><p>This only renders the <code>Person</code> node for Amanda Volkmann. To also render the nodes connect via an edge, click the node to display a ring around it and then click the graph icon in the ring.</p><p><img alt="Neo4j Amanda with ring" class="keep-size" src="/blog/assets/neo4j-amanda-ring.png"></p><p>The resulting displays is as follows:</p><p><img alt="Neo4j Amanda with links" class="keep-size" src="/blog/assets/neo4j-amanda-with-links.png"></p><h2 id="cleaning-up">Cleaning up</h2><p>To delete every node and the edges between them, enter the following Cypher command:</p><pre class="language-text"><code class="language-text">match (n) detach delete n</code></pre><p>To verify that everything has been deleted, enter the following Cypher command:</p><pre class="language-text"><code class="language-text">match (n) return n</code></pre><h2 id="creating-and-restoring-backups">Creating and restoring backups</h2><p>TODO</p><h2 id="accessing-from-a-web-app">Accessing from a web app</h2><p>The npm package <a href="https://github.com/neo4j-contrib/neovis.js" rel="noopener" target="_blank">neovis.js</a> supports rendering diagrams based on Neo4j Cypher queries. This builds on the npm package <a href="https://visjs.github.io/vis-network/docs/network/" rel="noopener" target="_blank">vis-network</a> for the visualization implementation.</p><p>For detailed documentation on options, see <a href="https://visjs.github.io/vis-network/docs/network/" rel="noopener" target="_blank">vis.js</a>.</p><p>Here is an example of a simple web page that renders the <code>Person</code> and <code>Dog</code> nodes created earlier.</p><pre class="language-html"><code class="language-html"></code></pre><p>Hover over a node or edge to see its attributes in a popup.</p></article>